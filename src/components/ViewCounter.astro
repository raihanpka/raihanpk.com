---
import { Eye } from 'lucide-react'
import { Separator } from '@/components/ui/separator'
interface Props {
  slug: string
}

const { slug } = Astro.props

let pageViews = 0
try {
  const pageViewsResponse = await fetch(`${Astro.url.origin}/api/viewcounter`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ slug }),
  })
  const result = await pageViewsResponse.json()
  pageViews = result.count || 0
} catch (error) {
  console.error('ViewCounter error:', error)
  pageViews = 0
}
---
<Separator orientation="vertical" className="h-4" />
<span class="flex items-center gap-1">
    <Eye /> {pageViews} views
</span>