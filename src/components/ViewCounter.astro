---
import prisma from '@/lib/prisma'
import { Eye } from 'lucide-react'
import { Separator } from '@/components/ui/separator'

let pageViews: any;
const slug = Astro.props.slug;

try {
    pageViews = await prisma.views.upsert({
        where: { slug },
        create: { slug, count: 1 },
        update: { count: { increment: 1 } },
        select: { slug: true, count: true },
    });
} catch (error) {
    console.error(error);
    pageViews = { slug, count: 1 };
}
---
<Separator orientation="vertical" className="h-4" />
<span class="flex items-center gap-1">
    <Eye /> {pageViews.count} views
</span>